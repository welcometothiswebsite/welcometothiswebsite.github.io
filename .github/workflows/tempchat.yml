name: Generate Random Temp Link
on: [push] # Triggers when you push any change to your repo

jobs:
  create_temp_page:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Generate Random Name and Clone
        run: |
          # 1. Generate 20 random alphanumeric characters
          RAND_ID=$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 20 | head -n 1)
          FILENAME="temp-${RAND_ID}.html"
          
          # 2. Clone your existing file (replace 'your-file.html' with your actual file name)
          cp your-file.html $FILENAME
          
          # 3. Store filename for later steps
          echo "TEMP_FILE=$FILENAME" >> $GITHUB_ENV
          echo "Created file: $FILENAME"

      - name: Push to Repository
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add ${{ env.TEMP_FILE }}
          git commit -m "Create temporary link: ${{ env.TEMP_FILE }}"
          git push

      - name: Wait 1 Hour
        run: sleep 3600

      - name: Delete and Expire Link
        run: |
          git rm ${{ env.TEMP_FILE }}
          git commit -m "Expire temporary link: ${{ env.TEMP_FILE }}"
          git push
